%%Fig.17-23
%method 1:
clear all clc 
% k=1;b1=0.6;a1=0.3;
% q=-1:0.01:1;
% f=q+2*k*(-(a1-q).*(1-1./(sqrt(b1.^2+(a1-q).^2)))+ (a1+q).* (1-1./(sqrt(b1.^2+(a1+q).^2))));
% % plot(q,f,'c','linewidth',4);grid on;hold on;
k1=0.2;k3=0.71;k5=3.5;k7=-4.6;k9=1.8;%polynomial fitted coefficients
Z_min=0.1;Z_max=1.0;%(Amplitude range)
Z=linspace(Z_min,Z_max,100);
Omega=zeros(length(Z),2);
A=0.05;
for i=1:length(Z)
   G(i)=(k1+3/4*k3*Z(i).^2+5/8*k5*Z(i).^4+35/64*k7*Z(i).^6+63/128*k9*Z(i).^8)./5;
   B(i)=sqrt(G(i));
   z(i)=A.^2./(4*G(i).*Z(i).^2);
   Omega(i,1)=sqrt(-(2.*z(i)-G(i))+(sqrt((4*Z(i).^4.*(2.*z(i)-G(i)).^2)-(4*Z(i).^2.*(Z(i).^2.*G(i).^2-A.^2))))./ (2*Z(i).^2));
   Omega(i,2)=sqrt(-(2.*z(i)-G(i))-(sqrt((4*Z(i).^4.*(2.*z(i)-G(i)).^2)-(4*Z(i).^2.*(Z(i).^2.*G(i).^2-A.^2))))./ (2*Z(i).^2));
end
T=imag(Omega(:,1))==0 & imag(Omega(:,2))==0;%Simultaneously zero
plot(Omega(T,:),Z(T),'g','linewidth',5);hold on;
axis([0.1 1.4 0 1.2]);

%%
%method 2: contour function.
clc;clear all
k1=1.2;k3=0.71;k5=3.5;k7=-4.6;k9=1.8;A=0.05;
% syms Z
% G=(k1+3/4*k3*Z.^2+5/8*k5*Z.^4+35/64*k7*Z.^6+63/128*k9*Z.^8)./5;
% z=A.^2./(4*G.*Z.^2);
f1=@(Omega,Z) Omega.^2+2*A.^2./(4*((k1+3/4*k3*Z.^2+5/8*k5*Z.^4+35/64*k7*Z.^6+63/128*k9*Z.^8)./5).*Z.^2)...
    -((k1+3/4*k3*Z.^2+5/8*k5*Z.^4+35/64*k7*Z.^6+63/128*k9*Z.^8)./5)+...
    +(sqrt(Z.^2.*(2*(A.^2./(4*((k1+3/4*k3*Z.^2+5/8*k5*Z.^4+35/64*k7*Z.^6+63/128*k9*Z.^8)./5).*Z.^2))...
    -((k1+3/4*k3*Z.^2+5/8*k5*Z.^4+35/64*k7*Z.^6+63/128*k9*Z.^8)./5)).^2 ...
    -(Z.^2.*((k1+3/4*k3*Z.^2+5/8*k5*Z.^4+35/64*k7*Z.^6+63/128*k9*Z.^8)./5).^2-A.^2)))./Z;
f2=@(Omega,Z) Omega.^2+2*A.^2./(4*((k1+3/4*k3*Z.^2+5/8*k5*Z.^4+35/64*k7*Z.^6+63/128*k9*Z.^8)./5).*Z.^2)...
    -((k1+3/4*k3*Z.^2+5/8*k5*Z.^4+35/64*k7*Z.^6+63/128*k9*Z.^8)./5)+...
    -(sqrt(Z.^2.*(2*(A.^2./(4*((k1+3/4*k3*Z.^2+5/8*k5*Z.^4+35/64*k7*Z.^6+63/128*k9*Z.^8)./5).*Z.^2))...
    -((k1+3/4*k3*Z.^2+5/8*k5*Z.^4+35/64*k7*Z.^6+63/128*k9*Z.^8)./5)).^2 ...
    -(Z.^2.*((k1+3/4*k3*Z.^2+5/8*k5*Z.^4+35/64*k7*Z.^6+63/128*k9*Z.^8)./5).^2-A.^2)))./Z;
fcontour(f1,[0.1 1.4 0.1 1.5],'r','linewidth',3);hold on;
fcontour(f2,[0.1 1.4 0.1 1.5],'b','linewidth',3);
% plot(Omega(:,1),B,'r','linewidth',5);hold on;
